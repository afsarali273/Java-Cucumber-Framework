<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Steps Reference - Sands Framework</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <button class="mobile-menu-btn" id="mobile-menu-btn">â˜°</button>
  
  <div class="container">
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>ðŸš€ Sands Framework</h1>
        <p>Enterprise Automation</p>
      </div>
      <nav>
        <ul class="nav-menu">
          <li class="nav-item"><a href="index.html" class="nav-link"><i class="fas fa-home"></i>Home</a></li>
          <li class="nav-item"><a href="api-automation.html" class="nav-link"><i class="fas fa-code"></i>API Automation</a></li>
          <li class="nav-item"><a href="api-steps-reference.html" class="nav-link active"><i class="fas fa-list"></i>API Steps Reference</a></li>
        </ul>
      </nav>
    </aside>

    <main class="main-content">
      <header class="header">
        <h1>API Steps Reference</h1>
        <div class="header-actions">
          <input type="text" id="search-box" class="search-box" placeholder="Search...">
          <button id="theme-toggle" class="theme-toggle">ðŸŒ™</button>
        </div>
      </header>

      <section class="section">
        <div class="alert alert-success">
          <strong>170+ Step Definitions</strong> for comprehensive REST/SOAP API automation with external files, query parameters, and variable substitution
        </div>
      </section>

      <section class="section">
        <h2>HTTP Methods (8 steps)</h2>
        <pre><code>When user sends GET request to "/users/1"
When user sends GET request to "/users/${userId}"
When user sends POST request to "/users"
When user sends PUT request to "/users/1"
When user sends DELETE request to "/users/1"
When user sends "GET" request to "/endpoint"
When user sends "POST" request to "/endpoint"
When user sends "PUT" request to "/endpoint"</code></pre>
      </section>

      <section class="section">
        <h2>Service Switching (5 steps)</h2>
        <pre><code>Given user switches to "userService" API service
Given user uses custom base URL "https://api.example.com"
When user sends "GET" request to "users" service endpoint "/list"
When user sends GET request to "users" service endpoint "/list"
When user sends POST request to "orders" service endpoint "/create"</code></pre>
      </section>

      <section class="section">
        <h2>Request Body (10 steps)</h2>
        <pre><code>When user creates POST request body with title "Test" and body "Content"
When user sets request body:
  """
  {"name": "John", "email": "john@example.com"}
  """
When user sets request body from file "testdata/request.json"
When user sets request body from file "${requestFile}"

# External JSON/XML Files with Variable Replacement
When user sends POST request to "/users" with body from file "testData/rest/createUser.json"
When user sends POST request to "/posts" with body from file "${jsonFile}"
When user sends PUT request to "/users/1" with body from file "testData/rest/updateUser.json"
When user sends SOAP request to "/soap/users" with body from file "testData/soap/getUserRequest.xml"
When user sends SOAP request to "/soap/orders" with body from file "${soapFile}"
When user sends "POST" request to "/api/data" with body from file "testData/custom.json"</code></pre>
      </section>

      <section class="section">
        <h2>Headers & Query Params (18 steps)</h2>
        <pre><code># Headers
When user sets header "Authorization" as "Bearer ${token}"
When user sets header "Content-Type" as "application/json"
When user sends "GET" request to "/users" with headers
When user applies headers

# Query Parameters - Individual
When user sets query param "page" as "1"
When user sets query param "limit" as "10"
When user sends GET request to "/users" with query params

# Query Parameters - DataTable (Recommended)
When user sets query parameters:
  | page   | 1      |
  | limit  | 10     |
  | sort   | name   |
  | order  | asc    |

# Query Parameters - Inline Format
When user sets query parameters "page=1&limit=10&sort=name"
When user sets query parameters "status=${status}&role=${role}"

# Query Parameters - From Properties File
When user sets query parameters from file "testData/queryParams/searchParams.properties"
When user sets query parameters from file "${paramsFile}"

# Query Parameters - From JSON File
When user sets query parameters from json file "testData/queryParams/userFilters.json"
When user sets query parameters from json file "${jsonParamsFile}"

# Combined Steps (Request + Query Params)
When user sends GET request to "/users" with query parameters:
  | page   | 1      |
  | limit  | 10     |
When user sends POST request to "/search" with query parameters:
  | filter | active |

# Clear Query Parameters
When user clears query parameters</code></pre>
      </section>

      <section class="section">
        <h2>Authentication (4 steps)</h2>
        <pre><code>When user sets basic auth with username "admin" and password "password"
When user sets bearer token from response json "token" as header "Authorization"
When user sets content type "application/json"
When user sets accept header "application/json"</code></pre>
      </section>

      <section class="section">
        <h2>Status Code Validation (1 step)</h2>
        <pre><code>Then response status code should be 200
Then response status code should be 201
Then response status code should be 400
Then response status code should be 404</code></pre>
      </section>

      <section class="section">
        <h2>Field Validation (4 steps)</h2>
        <pre><code>Then response should contain "id" field
Then response "name" should be "John Doe"
Then response "email" should be "${expectedEmail}"
Then response "id" should not be null
Then response "deletedAt" should be null</code></pre>
      </section>

      <section class="section">
        <h2>JSON Path Validation (8 steps)</h2>
        <pre><code>Then json path "data.name" should be "John"
Then json path "user.email" should contain "@example.com"
Then json path "data.id" should not be null
Then json path "error" should be null
Then json path "data.age" should be greater than 18
Then json path "data.score" should be less than 100
Then json array "users" should have size 10
Then json array "items" should contain "Product1"</code></pre>
      </section>

      <section class="section">
        <h2>Response Validation (8 steps)</h2>
        <pre><code>Then response time should be less than 2000 ms
Then response content type should be "application/json"
Then response header "Content-Type" should be "application/json"
Then response header "Authorization" should exist
Then response body should not be empty
Then response body should contain "success"
Then response should be valid json
Then response should match json schema "schemas/user-schema.json"</code></pre>
      </section>

      <section class="section">
        <h2>Advanced Assertions (20 steps)</h2>
        <pre><code>Then json path "email" should match regex "^[\\w.-]+@[\\w.-]+\\.\\w+$"
Then json path "status" should be of type "string"
Then json path "age" should be of type "number"
Then json path "active" should be of type "boolean"
Then response json should equal file "expected/response.json"
Then json path "user" keys should contain "id,name,email"
Then json array "users" elements should be sorted by "name" in "asc" order
Then json path "createdAt" should be ISO8601 within 60 seconds
Then response header "Cache-Control" should match regex "max-age=\\d+"
Then response header "X-Custom" should not exist
Then cookie "session" should exist
Then cookie "session" should be "${sessionId}"
Then response body size should be less than 5000 bytes
Then json array "users" should have unique values by "email"
Then at least one element in json array "users" should have "role" equal "admin"
Then jwt in json path "token" should not be expired
Then response encoding should be "gzip"</code></pre>
      </section>

      <section class="section">
        <h2>Variable Management (5 steps)</h2>
        <pre><code>When user saves json path "data.id" as "userId"
When user saves json path "token" as "authToken"
When user saves response body as "fullResponse"
When user saves response header "Location" as "resourceUrl"
When user saves response time as "responseTime"</code></pre>
      </section>

      <section class="section">
        <h2>Advanced Operations (8 steps)</h2>
        <pre><code>When user uploads file "testdata/document.pdf" to "/upload" as multipart field "file"
When user polls "/status" until json path "state" equals "completed" within 30 seconds interval 5 seconds
When user retries last request up to 3 times with interval 2 seconds until status 200
When user logs response
When user clears saved variables
When user clears request spec and headers
Then response header "ETag" should contain "W/"
Then response header "Location" should contain "/users/"</code></pre>
      </section>

      <section class="section">
        <h2>SOAP Support (5 steps)</h2>
        <pre><code>When user creates SOAP envelope with action "GetUser" and body:
  """
  &lt;GetUserRequest&gt;
    &lt;UserId&gt;123&lt;/UserId&gt;
  &lt;/GetUserRequest&gt;
  """
When user sends SOAP request to "/soap/users" with action "GetUser"
Then SOAP response should not have fault
Then SOAP response should have fault
Then SOAP xpath "//UserId" should be "123"</code></pre>
      </section>

      <section class="section">
        <h2>Data-Driven Testing (3 steps)</h2>
        <pre><code>Given Access "https://api.example.com" with "Authorization: Bearer token" for "TC001"
When Send "GET"
When Send "POST" with request body "payload"
Then verify request is success with status "200"
Then verify "name" in response body is "John"</code></pre>
      </section>

      <section class="section">
        <h2>External Files - Complete Examples</h2>
        
        <h3>Example 1: REST API with External JSON</h3>
        <pre><code>Scenario: Create user from external JSON file
  Given user switches to "userService" API service
  And user sets header "Content-Type" as "application/json"
  # Store variables for replacement
  And user saves "John Doe" as "userName"
  And user saves "john@example.com" as "userEmail"
  # Send request with external file (variables replaced automatically)
  When user sends POST request to "/users" with body from file "testData/rest/createUser.json"
  Then response status code should be 201
  And response "name" should be "John Doe"
  And response "email" should be "john@example.com"</code></pre>

        <h3>Example 2: SOAP API with External XML</h3>
        <pre><code>Scenario: Get user details via SOAP
  Given user switches to "soapService" API service
  And user sets header "Content-Type" as "text/xml"
  # Store userId for replacement
  And user saves "12345" as "userId"
  # Send SOAP request with external XML file
  When user sends SOAP request to "/soap/users" with body from file "testData/soap/getUserRequest.xml"
  Then response status code should be 200
  And SOAP response should not have fault
  And SOAP xpath "//UserId" should be "12345"</code></pre>

        <h3>Example 3: Query Parameters with DataTable</h3>
        <pre><code>Scenario: Search users with multiple filters
  When user sends GET request to "/users" with query parameters:
    | page       | 1        |
    | limit      | 20       |
    | status     | active   |
    | role       | admin    |
    | sortBy     | name     |
    | order      | asc      |
  Then response status code should be 200
  And json array "data" should have size 20</code></pre>

        <h3>Example 4: Query Parameters from External File</h3>
        <pre><code>Scenario: Search with parameters from properties file
  # Store variables for replacement
  Given user saves "active" as "status"
  And user saves "admin" as "role"
  # Load query params from file (variables replaced)
  When user sets query parameters from file "testData/queryParams/searchParams.properties"
  And user sends GET request to "/users"
  Then response status code should be 200</code></pre>

        <h3>Example 5: Combined External Files</h3>
        <pre><code>Scenario: Create order with external JSON and query params
  # Set variables
  Given user saves "PROD123" as "productId"
  And user saves "5" as "quantity"
  And user saves "express" as "shipping"
  # Load query params from JSON file
  When user sets query parameters from json file "testData/queryParams/orderParams.json"
  # Send POST with external JSON body
  And user sends POST request to "/orders" with body from file "testData/rest/createOrder.json"
  Then response status code should be 201
  And response "productId" should be "PROD123"</code></pre>
      </section>

      <section class="section">
        <h2>Complete Example</h2>
        <h3>Feature File</h3>
        <pre><code>@API @Regression
Feature: User Management API

  Background:
    Given user switches to "userService" API service
    And user sets header "Content-Type" as "application/json"

  Scenario: Create new user
    When user sets request body:
      """
      {
        "name": "John Doe",
        "email": "john@example.com",
        "role": "admin"
      }
      """
    And user sends POST request to "/users"
    Then response status code should be 201
    And response "name" should be "John Doe"
    And response "id" should not be null
    When user saves json path "id" as "userId"
    And user saves json path "email" as "userEmail"

  Scenario: Get user by ID
    When user sends GET request to "/users/${userId}"
    Then response status code should be 200
    And json path "email" should be "${userEmail}"
    And json path "role" should be "admin"
    And response time should be less than 1000 ms

  Scenario: Update user
    When user sets request body:
      """
      {
        "name": "John Updated",
        "email": "${userEmail}"
      }
      """
    And user sends PUT request to "/users/${userId}"
    Then response status code should be 200
    And json path "name" should be "John Updated"

  Scenario: Search users with pagination
    When user sets query param "page" as "1"
    And user sets query param "limit" as "10"
    And user sends GET request to "/users" with query params
    Then response status code should be 200
    And json array "data" should have size 10
    And json path "pagination.page" should be 1

  Scenario: Validate user email format
    When user sends GET request to "/users/${userId}"
    Then json path "email" should match regex "^[\\w.-]+@[\\w.-]+\\.\\w+$"
    And json path "email" should be of type "string"

  Scenario: Delete user
    When user sends DELETE request to "/users/${userId}"
    Then response status code should be 204

  Scenario Outline: Create multiple users
    When user sets request body:
      """
      {
        "name": "<name>",
        "email": "<email>",
        "role": "<role>"
      }
      """
    And user sends POST request to "/users"
    Then response status code should be 201
    And json path "name" should be "<name>"

    Examples:
      | name        | email              | role   |
      | Alice Smith | alice@example.com  | user   |
      | Bob Jones   | bob@example.com    | admin  |
      | Carol White | carol@example.com  | user   |</code></pre>
      </section>

      <section class="section">
        <h2>Variable Substitution</h2>
        <p>All steps support <code>${variableName}</code> syntax for dynamic values:</p>
        <pre><code>When user saves json path "token" as "authToken"
And user sets header "Authorization" as "Bearer ${authToken}"
And user sends GET request to "/users/${userId}"
Then json path "email" should be "${expectedEmail}"</code></pre>
      </section>

      <section class="section">
        <h2>Tips & Best Practices</h2>
        <ul>
          <li>âœ… Use Background for common setup (headers, base URL)</li>
          <li>âœ… Save IDs and tokens to variables for reuse</li>
          <li>âœ… Validate status codes first, then response body</li>
          <li>âœ… Use json path for nested field validation</li>
          <li>âœ… Add response time assertions for performance</li>
          <li>âœ… Use regex for format validation (email, phone, etc.)</li>
          <li>âœ… Leverage service switching for microservices</li>
          <li>âœ… Use data tables for multiple similar requests</li>
          <li>âœ… Clear variables between independent scenarios</li>
          <li>âœ… Log responses for debugging</li>
          <li>âœ… <strong>Use external JSON/XML files for complex request bodies</strong></li>
          <li>âœ… <strong>Store test data in testData/ folder with proper structure</strong></li>
          <li>âœ… <strong>Use DataTable for query parameters (most readable)</strong></li>
          <li>âœ… <strong>Leverage ${variable} replacement in external files</strong></li>
          <li>âœ… <strong>Use properties/JSON files for reusable query parameter sets</strong></li>
        </ul>
      </section>

      <footer class="footer">
        <p>&copy; 2025 Sands Automation Framework. Created by Afsar Ali</p>
      </footer>
    </main>
  </div>

  <script src="js/main.js"></script>
</body>
</html>
